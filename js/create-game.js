(function () {
    const scriptSrc = "https://tvisher.github.io/card-game/js/grid-game.js";
    const currentScript = document.currentScript;
    const cardGameContainer = document.createElement('div');
    cardGameContainer.classList.add('grid-game');

    const cardGameWrapper = document.createElement('div');
    cardGameWrapper.classList.add('application_wrapper');
    cardGameWrapper.append(cardGameContainer);
    currentScript.before(cardGameWrapper);

    const freeVersionNameplate = `
        <a href="https://vnutricom.ru/lk/" class="application_dev" style="margin-top: -15px;text-decoration:none">
            <span>Сделано в бесплатной версии</span>
            <div class="dev-logo">
                <svg width="127" height="27" viewBox="0 0 127 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M21.4828 22.7169H18.7969V9.54688H19.1674C19.26 9.54688 19.3526 9.54688 19.4452 9.54688C19.5378 9.54688 19.6304 9.54688 19.7231 9.54688C19.9083 9.54688 20.0935 9.54688 20.2788 9.63897C20.464 9.63897 20.6492 9.73107 20.8345 9.82317C21.0197 9.91527 21.205 10.0995 21.2976 10.2837C21.3902 10.3758 21.4828 10.6521 21.4828 10.9283V22.7169Z"
                        fill="black" />
                    <path
                        d="M32.0394 18.6708V9.55304H32.3173C32.4099 9.55304 32.5025 9.55304 32.5951 9.55304C32.6877 9.55304 32.7804 9.55304 32.873 9.55304C33.0582 9.55304 33.2434 9.55304 33.4287 9.64513C33.6139 9.64513 33.7992 9.73723 33.9844 9.82933C34.1696 9.92143 34.2623 10.1056 34.4475 10.2898C34.5401 10.474 34.6327 10.7503 34.6327 11.1187V22.9073H32.3173L26.6675 14.0658V22.8152H24.0742V9.55304C24.1668 9.46094 24.3521 9.46094 24.5373 9.46094C24.7225 9.46094 25.0004 9.46094 25.1856 9.46094C25.6487 9.46094 25.9266 9.55304 26.2044 9.64513C26.4823 9.82933 26.6675 10.0135 26.8528 10.2898L32.0394 18.6708Z"
                        fill="black" />
                    <path
                        d="M40.2839 11.6713H36.1161C36.1161 11.4871 36.1161 11.395 36.0234 11.3029C36.0234 11.2108 36.0234 11.0266 36.0234 10.9345C36.0234 10.5661 36.1161 10.2898 36.3939 9.92143C36.6718 9.64513 37.1349 9.46094 37.6906 9.46094H47.045C47.045 9.73723 47.1377 10.0135 47.1377 10.2898C47.1377 10.6582 47.045 10.9345 46.7672 11.2108C46.4893 11.4871 46.1189 11.6713 45.4705 11.6713H42.9698V22.7231H40.1913V11.6713H40.2839Z"
                        fill="black" />
                    <path
                        d="M55.6573 20.6969C56.3057 20.6969 56.7688 20.8811 56.954 21.1574C57.2319 21.4337 57.3245 21.8021 57.3245 22.1705C57.3245 22.3547 57.3245 22.4468 57.3245 22.5389C57.3245 22.631 57.3245 22.7231 57.3245 22.9073H48.7109V9.46094H57.0466C57.0466 9.64513 57.0466 9.73723 57.1392 9.82933C57.1392 9.92143 57.1392 10.0135 57.1392 10.1977C57.1392 10.6582 57.0466 11.0266 56.7688 11.2108C56.4909 11.395 56.1204 11.5792 55.4721 11.5792H51.5821V14.8026H55.8426V16.9209H51.5821V20.6048H55.6573V20.6969Z"
                        fill="black" />
                    <path
                        d="M68.1614 13.3274C68.1614 13.88 68.0688 14.3405 67.9762 14.801C67.7909 15.1694 67.6057 15.5378 67.4205 15.9062C67.1426 16.1825 66.8648 16.4587 66.5869 16.735C66.3091 16.9192 65.9386 17.1034 65.6607 17.1955L68.9024 22.6293C68.6245 22.7214 68.3467 22.8135 68.0688 22.9056C67.791 22.9977 67.5131 22.9977 67.2352 22.9977C66.7722 22.9977 66.3091 22.9056 66.0312 22.7214C65.6607 22.5372 65.3829 22.1688 65.105 21.7083L62.8822 17.7481H61.7707V22.7214H58.9922V9.55138C59.6405 9.45929 60.2888 9.45929 60.9372 9.45929C61.5855 9.45929 62.1412 9.36719 62.6043 9.36719C64.5493 9.36719 65.9386 9.73558 66.8648 10.3803C67.6983 11.025 68.1614 11.9459 68.1614 13.3274ZM65.2903 13.5116C65.2903 12.6827 65.105 12.1301 64.6419 11.7617C64.1788 11.4854 63.6231 11.3012 62.8822 11.3012C62.6043 11.3012 62.4191 11.3012 62.2338 11.3012C62.0486 11.3012 61.956 11.3012 61.7707 11.3012V15.9062H62.6969C63.5305 15.9062 64.0862 15.722 64.5493 15.3536C65.105 14.9852 65.2903 14.3405 65.2903 13.5116Z"
                        fill="black" />
                    <path
                        d="M80.9492 21.9859C80.8566 22.078 80.764 22.17 80.5788 22.2621C80.3935 22.3542 80.1157 22.5384 79.8378 22.6305C79.56 22.7226 79.1895 22.8147 78.7264 22.9068C78.2633 22.9989 77.8002 22.9989 77.2445 22.9989C76.1331 22.9989 75.2069 22.8147 74.4659 22.4463C73.725 22.078 73.0767 21.6175 72.521 20.9728C71.9652 20.3281 71.5948 19.5913 71.4095 18.7624C71.1317 17.9335 71.0391 17.0125 71.0391 15.9995C71.0391 14.9864 71.1317 14.0654 71.4095 13.2365C71.6874 12.4076 72.0579 11.6708 72.6136 11.0262C73.1693 10.3815 73.8176 9.92098 74.5586 9.55259C75.2995 9.1842 76.2257 9 77.3371 9C77.8928 9 78.3559 9.0921 78.7264 9.1842C79.1895 9.27629 79.4673 9.36839 79.8378 9.55259C80.1157 9.64469 80.3935 9.82888 80.5788 9.92098C80.764 10.1052 80.9492 10.1973 81.0419 10.2894C81.1345 10.3815 81.2271 10.5657 81.3197 10.6578C81.4123 10.842 81.4123 10.9341 81.4123 11.1183C81.4123 11.3946 81.3197 11.6708 81.1345 11.9471C80.9492 12.2234 80.6714 12.4997 80.4861 12.6839C80.3009 12.4997 80.1157 12.4076 79.9304 12.2234C79.7452 12.0392 79.4673 11.9471 79.2821 11.7629C79.0043 11.6708 78.7264 11.4867 78.4485 11.4867C78.1707 11.3946 77.8002 11.3946 77.4297 11.3946C76.7814 11.3946 76.2257 11.4867 75.7626 11.7629C75.2995 12.0392 74.929 12.4076 74.6512 12.8681C74.3733 13.3286 74.1881 13.7891 74.0955 14.3417C74.0029 14.8943 73.9102 15.4469 73.9102 16.0916C73.9102 16.7363 74.0029 17.2888 74.0955 17.8414C74.1881 18.394 74.4659 18.9466 74.7438 19.315C75.0217 19.7755 75.3921 20.1439 75.8552 20.3281C76.3183 20.6044 76.874 20.6965 77.615 20.6965C77.9854 20.6965 78.3559 20.6044 78.6338 20.5123C78.9116 20.4202 79.1895 20.3281 79.4673 20.1439C79.7452 20.0518 79.9304 19.8676 80.1157 19.6834C80.3009 19.4992 80.4861 19.4071 80.5788 19.315C80.6714 19.4071 80.764 19.4992 80.8566 19.6834C80.9492 19.7755 81.0419 19.9597 81.1345 20.1439C81.2271 20.3281 81.3197 20.4202 81.4123 20.6044C81.505 20.7886 81.505 20.8807 81.505 20.9728C81.505 21.157 81.505 21.2491 81.4123 21.4333C81.2271 21.7096 81.1345 21.8938 80.9492 21.9859Z"
                        fill="black" />
                    <path
                        d="M94.6565 16.0932C94.6565 17.0142 94.5638 17.9352 94.286 18.7641C94.1008 19.5929 93.7303 20.3297 93.1746 20.9744C92.7115 21.6191 92.0631 22.0796 91.3222 22.448C90.5812 22.8164 89.6551 23.0006 88.5436 23.0006C87.4322 23.0006 86.506 22.8164 85.7651 22.448C85.0241 22.0796 84.3758 21.527 83.9127 20.8823C83.4496 20.2376 83.0792 19.5008 82.8939 18.672C82.7087 17.8431 82.5234 16.9221 82.5234 16.0011C82.5234 15.0801 82.6161 14.1592 82.8939 13.3303C83.1718 12.5014 83.5422 11.7646 84.0053 11.1199C84.4684 10.4752 85.1168 10.0147 85.9503 9.64634C86.6913 9.27795 87.6175 9.09375 88.7289 9.09375C89.7477 9.09375 90.6739 9.27795 91.4148 9.64634C92.1558 10.0147 92.8041 10.4752 93.2672 11.1199C93.7303 11.7646 94.1008 12.5014 94.286 13.3303C94.5638 14.2512 94.6565 15.0801 94.6565 16.0932ZM91.8779 16.0932C91.8779 15.4485 91.7853 14.8959 91.6927 14.2512C91.6001 13.6987 91.4148 13.1461 91.137 12.7777C90.8591 12.3172 90.5812 12.0409 90.1182 11.7646C89.7477 11.4883 89.192 11.3962 88.6363 11.3962C87.9879 11.3962 87.5248 11.4883 87.0617 11.7646C86.5987 12.0409 86.3208 12.3172 86.0429 12.7777C85.7651 13.2382 85.5798 13.6987 85.4872 14.2512C85.3946 14.8038 85.302 15.4485 85.302 16.0932C85.302 16.7379 85.3946 17.2905 85.4872 17.9352C85.5798 18.4878 85.7651 19.0404 86.0429 19.5008C86.3208 19.9613 86.5987 20.3297 87.0617 20.606C87.4322 20.8823 87.9879 20.9744 88.5436 20.9744C89.0994 20.9744 89.6551 20.8823 90.0255 20.606C90.396 20.3297 90.7665 19.9613 91.0443 19.5008C91.3222 19.0404 91.5074 18.5799 91.6001 17.9352C91.7853 17.3826 91.8779 16.7379 91.8779 16.0932Z"
                        fill="black" />
                    <path
                        d="M99.0088 9.37109C99.4719 9.37109 99.7498 9.46319 100.028 9.64739C100.305 9.83158 100.491 10.1079 100.583 10.4763L103.64 17.5678L106.696 10.5684C106.881 10.1079 107.159 9.83158 107.437 9.64739C107.715 9.46319 107.993 9.37109 108.363 9.37109C108.641 9.37109 108.919 9.37109 109.197 9.46319C109.475 9.46319 109.66 9.55529 109.753 9.55529L110.679 22.7253H108.085L107.437 13.976L104.751 19.9624H102.436L99.8424 14.1602L99.2867 22.7253H96.6934L97.7122 9.55529C97.8048 9.55529 98.0826 9.46319 98.2679 9.46319C98.4531 9.46319 98.731 9.37109 99.0088 9.37109Z"
                        fill="black" />
                    <path
                        d="M115.031 9.37109C115.495 9.37109 115.772 9.46319 116.05 9.64739C116.328 9.83158 116.513 10.1079 116.606 10.4763L119.662 17.5678L122.719 10.5684C122.904 10.1079 123.182 9.83158 123.46 9.64739C123.738 9.46319 124.015 9.37109 124.386 9.37109C124.664 9.37109 124.942 9.37109 125.219 9.46319C125.497 9.46319 125.683 9.55529 125.775 9.55529L126.701 22.7253H124.108L123.46 13.976L120.774 19.9624H118.551L115.958 14.1602L115.402 22.7253H112.809L113.827 9.55529C113.92 9.55529 114.198 9.46319 114.383 9.46319C114.476 9.46319 114.754 9.37109 115.031 9.37109Z"
                        fill="black" />
                    <path
                        d="M12.1662 9.51807C9.02892 8.26524 5.34786 8.93341 2.83806 11.4391C-0.550185 14.8217 -0.550185 20.2924 2.83806 23.675C5.34786 26.1807 9.02892 26.8488 12.1662 25.596V21.587C11.5387 21.8793 10.8694 22.0463 10.1583 22.0463C7.64852 22.0463 5.64067 20.0418 5.64067 17.5362C5.64067 15.0305 7.64852 13.026 10.1583 13.026C10.8694 13.026 11.5806 13.193 12.1662 13.4854V9.51807Z"
                        fill="#FA0056" />
                    <path
                        d="M10.7446 5.50007C11.9803 4.26122 11.9803 2.21071 10.7446 0.929138C9.50882 -0.309712 7.46342 -0.309712 6.18505 0.929138C4.90668 2.16799 4.9493 4.2185 6.18505 5.50007C7.46342 6.73892 9.50882 6.73892 10.7446 5.50007Z"
                        fill="#FA0056" />
                </svg>
            </div>
        </a>`;
    const gameId = currentScript.dataset.gameId;
    console.log(gameId);
    const initGame = () => {
        setTimeout(() => {
            const gameDataRes = {
                "isFreeVersion": true,
                "aspectRatio": '4-3',
                'desktopColumnSave': false,
                'arrowType': 'black',
                "cardImages": [
                    "https://swiperjs.com/demos/images/nature-5.jpg",
                    "https://swiperjs.com/demos/images/nature-6.jpg",
                    "https://swiperjs.com/demos/images/nature-7.jpg",

                    "https://swiperjs.com/demos/images/nature-5.jpg",
                    "https://swiperjs.com/demos/images/nature-6.jpg",
                    "https://swiperjs.com/demos/images/nature-7.jpg",

                    "https://swiperjs.com/demos/images/nature-5.jpg",
                    "https://swiperjs.com/demos/images/nature-6.jpg",
                    "https://swiperjs.com/demos/images/nature-7.jpg",
                ],
                'cardsText': [
                    'Подсказка для 1 карточки',
                    'Подсказка для 2 карточки',
                    'Подсказка для 3 карточки',
                    'Подсказка для 4 карточки',
                    'Подсказка для 5 карточки',
                    'Подсказка для 6 карточки',
                    'Подсказка для 7 карточки',
                    'Подсказка для 8 карточки',
                    'Подсказка для 9 карточки',

                ],
                'resultMessage': 'Какое то сообщение при успешной сборке игры',
            };
            new CardsGame({
                parentElement: cardGameContainer,
                gameData: gameDataRes,
            });
            if (gameDataRes.isFreeVersion) {
                cardGameWrapper.insertAdjacentHTML('beforeend', freeVersionNameplate);
            }
        }, 100);
    }
    if (!document.querySelector(`script[src="${scriptSrc}"]`)) {
        const stylesList = [
            'https://tvisher.github.io/card-game/css/grig-game-style.min.css',
            'https://tvisher.github.io/card-game/css/white-arrows.min.css',
            'https://tvisher.github.io/card-game/css/black-arrows.min.css'
        ];
        stylesList.forEach(link => {
            const gameStyle = document.createElement('link');
            gameStyle.rel = 'stylesheet';
            gameStyle.href = link;
            document.body.before(gameStyle);
        });

        const gameScript = document.createElement('script');
        gameScript.src = scriptSrc;
        document.body.append(gameScript);
        gameScript.onload = initGame
    } else {
        initGame()
    }
})()
